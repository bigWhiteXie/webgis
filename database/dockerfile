# 基于已有的 PostGIS 镜像
FROM postgis/postgis:15-3.4

# 设置环境变量（PostgreSQL 默认支持）
ENV POSTGRES_USER=postgres
ENV POSTGRES_PASSWORD=123456
ENV POSTGRES_DB=HydroVision

# 将 SQL 文件复制到 PostgreSQL 初始化目录
# 容器第一次启动时会自动执行这些脚本
COPY sql/gis/*.sql /docker-entrypoint-initdb.d/
COPY sql/system/*.sql /docker-entrypoint-initdb.d/

# 可选：为防止执行顺序混乱，你可以在 COPY 前加上前缀排序
# 例如：
# COPY sql/gis/*.sql /docker-entrypoint-initdb.d/01-gis/
# COPY sql/system/*.sql /docker-entrypoint-initdb.d/02-system/

# 暴露默认端口
EXPOSE 5432
